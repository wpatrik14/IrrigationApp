{% include "IrrigationApp/pages/frame/chartHeader2.html" %}		
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-more.js"></script>
<script src="https://rawgithub.com/highslide-software/draggable-points/master/draggable-points.js"></script>

<form class="form-horizontal" id="doAddIrrigationTemplate" action="{% url 'doAddIrrigationTemplate'%}" method="post">
				{% csrf_token %}
				<fieldset>

			<!-- Form Name -->
			<legend>Add irrigation template</legend>
			
			<!-- Text input-->
			<div class="form-group">
			  <label for="name">Name</label>
			    <input id="name" name="name" type="text" placeholder="Name" class="form-control" required="">
			</div>
			
			<input type="hidden" id="series" name="series" value="" />
			
			<div id="container" style="min-width: 310px; height: 400px; max-width: 900px; margin: 0 auto"></div>

			<!-- Button -->
				<div class="form-group">
				  <label for="submit"></label>
				    <button id="submit" name="submit" class="btn btn-success">Save Template</button>
				</div>
			
		</fieldset>
				</form>
				
		<div class="form-group">
				  <label for="button"></label>
				    <button id="button" name="button" class="btn btn-default">Add point</button>
				</div>
		<div id="drop"></div>


<script type="text/javascript">
	var chart = new Highcharts.Chart({

    chart: {
        renderTo: 'container',
        animation: false
    },
    
    title: {
        text: 'Highcharts draggable points demo'
    },

    xAxis: {
        categories: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
    },

    plotOptions: {
        series: {
            cursor: 'ns-resize',
            point: {
                events: {

                    drag: function (e) {
                        
                        if (e.newY > 100) {
                            this.y = 100;
                            return false;
                        } else if (e.newY < 0) {
                        	this.y = 0;
                            return false;
                        }
                    },
                    drop: function () {
                    	var datas0 = chart.series[0].data;
                    	datas0[this.category].low=e.newY-10;
                    	datas0[this.category].high=e.newY+10;
                    	
                    	chart.yAxis[0].setExtremes(0, 100);
                    }
                }
            },
            stickyTracking: false
        },
        column: {
            stacking: 'normal'
        }
    },

    tooltip: {
        yDecimals: 2
    },

    series: [{
            name: 'Range',
            data: [
            [0, 0, 20],
            [1, 0, 20],
            [2, 10, 30],
            [3, 20, 40],
            [4, 30, 50],
            [5, 40, 60],
            [6, 50, 70],
            [7, 60, 80],
            [8, 60, 80],
            [9, 60, 80],
            [10, 20, 40],
            [11, 20, 40]
        ],
            type: 'arearange',
            lineWidth: 0,
            linkedTo: ':previous',
            color: Highcharts.getOptions().colors[0],
            fillOpacity: 0.3,
            zIndex: 0
        },{
        	data: [10, 10, 20, 30, 40, 50, 60, 70, 70, 70, 30, 30],
        	draggableY: true
    	}]

});
</script>
<script type="text/javascript">
	// the button action
	$('#submit').click(function() {
	    var chart = $('#container').highcharts();
	    var datas = chart.series[0].data;
	    var result="{\"data\":[";
		                    for (var i=0; i<datas.length-1; i++) {
		                    	result+="{\"x\":\""+datas[i].x+"\",\"y\":\""+datas[i].y+"\"},";
		                    }
		                    result+="{\"x\":\""+datas[i].x+"\",\"y\":\""+datas[i].y+"\"}]}";
		                    document.getElementById('series').value = result;
	});
	$('#button').click(function() {
	    var chart = $('#container').highcharts();
	    var series = chart.series[0];
	    series.addPoint(50);
	});
	$(document).ready ( function(){
	   chart.yAxis[0].setExtremes(0, 100);
	});
</script>
</div>
</body>
</html>