{% include "IrrigationApp/pages/frame/chartHeader2.html" %}
<body>		
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-more.js"></script>
<script src="https://rawgithub.com/highslide-software/draggable-points/master/draggable-points.js"></script>
<div id="container" style="height: 400px"></div>
<div id="drag"></div>
<div id="drop"></div>

<script type="text/javascript">
	var chart = new Highcharts.Chart({

    chart: {
        renderTo: 'container',
        animation: false,
        events: {
		                click: function (e) {
		                    // find the clicked values and the series
		                    var x = e.xAxis[0].value,
		                        y = e.yAxis[0].value,
		                        series = this.series[0];
		
		                    // Add it
		                    var datas = series.data;
		                    var addPoint=1;
		                    for (var i=0; i<datas.length; i++) {
		                    	if (datas[i].x >= Math.round(x)){
		                    		addPoint=0;
		                    	}
		                    }
		                    if (addPoint==1 && y>=0 && y<=100){
		                    
		                    	var prev_point=datas[datas.length-1]
		                    	var diff_x=x-prev_point.x
		                    	var diff_y=y-prev_point.y
		                    	if (diff_x > 1) {
		                    		for (var i=1; i<diff_x; i++){
		                    			series.addPoint([Math.round(prev_point.x+i), Math.round(prev_point.y+(diff_y)*i/diff_x)]);
		                    		}
		                    	}
		                    	else if (diff_x <= 1){
		                    		series.addPoint([Math.round(x), Math.round(y)]);
		                    	}
		                    }
		                    var result="{\"data\":[";
		                    for (var i=0; i<datas.length-1; i++) {
		                    	result+="{\"x\":\""+datas[i].x+"\",\"y\":\""+datas[i].y+"\"},";
		                    }
		                    result+="{\"x\":\""+datas[i].x+"\",\"y\":\""+datas[i].y+"\"}]}";
		                    document.getElementById('series').value = result;		
		                }
		            }
    },
    
    title: {
        text: 'Highcharts draggable points demo'
    },

    xAxis: {
        //categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },

    plotOptions: {
        series: {
            cursor: 'ns-resize',
            point: {
                events: {

                    drag: function (e) {
                        // Returning false stops the drag and drops. Example:
                        /*
                        if (e.newY > 300) {
                            this.y = 300;
                            return false;
                        }
                        */
                        $('#drag').html(
                            'Dragging <b>' + this.series.name + '</b>, <b>' + this.category + '</b> to <b>' + Highcharts.numberFormat(e.newY, 2) + '</b>');
                    },
                    drop: function () {
                        $('#drop').html(
                            'In <b>' + this.series.name + '</b>, <b>' + this.category + '</b> was set to <b>' + Highcharts.numberFormat(this.y, 2) + '</b>');
                    }
                }
            },
            stickyTracking: false
        },
        column: {
            stacking: 'normal'
        }
    },

    tooltip: {
        yDecimals: 2
    },

    series: [{
        data: [0, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
        draggableY: true
    }]

});
</script>
</body>
</html>