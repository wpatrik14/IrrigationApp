{% include "IrrigationApp/pages/frame/htmlHeader_refresh.html" %}

<fieldset>

	<!-- Form Name -->
	<legend>Actual Weather</legend>

<table class="table table-striped table-condensed">
	{% for currentWeather in weathers %}
	<tr>
		<td>Icon:</td>
		<td><img src="{{ currentWeather.icon }}"></td>
	</tr>
	<tr>
		<td>Location:</td>
		<td>{{currentWeather.place}}</td>
	</tr>
	<tr>
		<td>Observation time:</td>
		<td>{{currentWeather.observation_time|date:"Y-m-d"}} {{currentWeather.observation_time|time:"H:i"}}</td>
	</tr>
	<tr>
		<td>Temp (C):</td>
		<td>{{currentWeather.temp_C}}</td>
	</tr>
	<tr>
		<td>Precipitation (mm):</td>
		<td>{{currentWeather.precipMM}}</td>
	</tr>
	<tr>
		<td>Pressure:</td>
		<td>{{currentWeather.pressure}}</td>
	</tr>
	<tr>
		<td>Cloudcover:</td>
		<td>{{currentWeather.cloudcover}}</td>
	</tr>
	<tr>
		<td>Humidity:</td>
		<td>{{currentWeather.humidity}}</td>
	</tr>
	<tr>
		<td>Wind speed (Kmph):</td>
		<td>{{currentWeather.windspeedKmph}}</td>
	</tr>
	<tr>
		<td>Wind direction:</td>
		<td>{{currentWeather.winddirDegree}}</td>
	</tr>
	{% endfor %}
</table>
</fieldset>

<fieldset>

	<!-- Form Name -->
	<legend>Status of the Segments</legend><a href="/showAddNewSegment">New Segment</a>

<table class="table table-striped table-condensed">
	<thead>
		<td>Segment name</td>
		<td>Sensor status</td>
		<td>Switch status</td>
		<td>UP-time</td>
		<td>Type</td>
		<td>Moisure min. limit</td>
		<td>Moisure max. limit</td>
		<td>Duration max. limit</td>
		<td>Forecast enabled</td>
		<td>Edit</td>
	</thead>
	{% for segment in segments %}
	<tr>
		<td>{{segment.name}}</td>
		<td>{{segment.sensor.status}}</td>
		<td>
			<form id="change_switch" action="getSystemStatus" method="post">
				{% csrf_token %}
				{% if segment.switch.status == "on" %}
				<input type="hidden" name="pinNumber" value = "{{ segment.switch.pinNumber }}"/>
				<input type="hidden" name="status" value = "off"/>
				<button id="switch" name="switch" class="btn btn-default">ON </button>
				{% else %}
				<input type="hidden" name="pinNumber" value = "{{ segment.switch.pinNumber }}"/>
				<input type="hidden" name="status" value = "on"/>
				<button id="switch" name="switch" class="btn btn-default">OFF</button>
				{% endif %}
			</form>
		</td>
		<td>{{segment.up_time}}</td>
		<td>{{segment.type}}</td>
		<td>{{segment.moisture_minLimit}}</td>
		<td>{{segment.moisture_maxLimit}}</td>
		<td>{{segment.duration_maxLimit}}</td>
		<td>{{segment.forecast_enabled}}</td>
		<td>
		<form id="showEditSegment" action="showEditSegment" method="post">
				{% csrf_token %}
				<input type="hidden" name="editSegment" value = "{{ segment.id }}"/>
				<button id="delete" name="delete" class="btn btn-default">EDIT</button>
			</form>		
		</td>
	</tr>
	{% endfor %}
</table>

</fieldset>

<fieldset>

	<!-- Form Name -->
	<legend>Simple schedules</legend>
	<a href="/showSimpleSchedule">New Simple Schedule</a>

<table class="table table-striped table-condensed">
	<thead>
		<td>Status</td>
		<td>Date</td>
		<td>Time</td>
		<td>Duration</td>
		<td>Segments</td>
		<td>Delete</td>
	</thead>
	{% for simpleSchedule in simpleSchedules %}
	<tr>
		<td>{{simpleSchedule.status}}</td>
		<td>{{simpleSchedule.date|date:"Y-m-d"}}</td>
		<td>{{simpleSchedule.time|time:"H:i"}}</td>
		<td>{{simpleSchedule.duration}}</td>
		<td>{{simpleSchedule.segment.name}}</td>
		<td>
		<form id="deleteSimpleSchedule" action="deleteSimpleSchedule" method="post">
				{% csrf_token %}
				<input type="hidden" name="simpleSchedule" value = "{{ simpleSchedule.id }}"/>
				<button id="delete" name="delete" class="btn btn-default">DELETE</button>
			</form>
		</td>
	</tr>
	{% endfor %}
</table>

</fieldset>

<fieldset>

	<!-- Form Name -->
	<legend>Repeatable schedules</legend>
	<a href="/showRepeatableSchedule">New Repeatable Schedule</a>

<table class="table table-striped table-condensed">
	<thead>
		<td>Schedule name</td>
		<td>Enabled</td>
		<td>Status</td>
		<td>Day</td>
		<td>Time</td>
		<td>Duration</td>
		<td>Segments</td>
		<td>Delete</td>
	</thead>
	{% for repeatableSchedule in repeatableSchedules %}
	<tr>
		<td>{{repeatableSchedule.name}}</td>
		<td>{{repeatableSchedule.enabled}}</td>
		<td>{{repeatableSchedule.status}}</td>
		<td>{{repeatableSchedule.day}}</td>
		<td>{{repeatableSchedule.time|time:"H:i"}}</td>
		<td>{{repeatableSchedule.duration}}</td>
		<td>{{repeatableSchedule.segment.name}}</td>
		<td>
		<form id="deleteRepeatableSchedule" action="deleteRepeatableSchedule" method="post">
				{% csrf_token %}
				<input type="hidden" name="repeatableSchedule" value = "{{ repeatableSchedule.id }}"/>
				<button id="delete" name="delete" class="btn btn-default">DELETE</button>
			</form>
		</td>
	</tr>
	{% endfor %}
</table>

</fieldset>

</body>
</html>